<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link th:href="@{/styles/css/main.css}" rel="stylesheet">
    <title>My Orders</title>
</head>
<body>
<header>
    <div th:insert="~{menunavy::navy}"></div>
</header>
<main class="container mt-3">
    <h1 th:text="#{orders.myOrders}">My Orders</h1>

    <form th:action="@{/my-orders}" method="get" class="mb-3">
        <div class="input-group">
            <input type="text" name="search" class="form-control"
                   placeholder="Search my orders..." th:value="${search}">
            <button class="btn btn-primary" type="submit">Search</button>
        </div>
    </form>

    <div th:if="${ordersPage.empty}" class="alert alert-info">
        No orders found
    </div>

    <table class="table table-hover" th:unless="${ordersPage.empty}">
        <thead class="table-dark">
        <tr>
            <th>
                <a th:href="@{/my-orders(sort='id,asc')}">ID</a>
            </th>
            <th>
                <a th:href="@{/my-orders(sort='totalAmount,asc')}">Amount</a>
            </th>
            <th>Status</th>
            <th>Operation</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="order : ${ordersPage.content}">
            <td th:text="${order.id}"></td>
            <td th:text="${@number.formatCurrency(order.totalAmount)}"></td>
            <td>
                    <span th:class="${order.approved} ? 'badge bg-success' : 'badge bg-warning'"
                          th:text="${order.approved} ? 'Approved' : 'Pending'">
                    </span>
            </td>
            <td>
                <a th:href="@{/orders/{id}/details(id=${order.id})}"
                   class="btn btn-sm btn-info">
                    Details
                </a>
            </td>
        </tr>
        </tbody>
    </table>

    <div th:if="${ordersPage.totalPages > 1}" class="mt-4">
        <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${ordersPage.first} ? 'disabled'">
                    <a class="page-link" th:href="@{/my-orders(page=${ordersPage.number-1}, search=${search}, sort=${param.sort})}">
                        Previous
                    </a>
                </li>
                <li class="page-item" th:each="i : ${#numbers.sequence(0, ordersPage.totalPages-1)}"
                    th:classappend="${i == ordersPage.number} ? 'active'">
                    <a class="page-link"
                       th:href="@{/my-orders(page=${i}, search=${search}, sort=${param.sort})}"
                       th:text="${i+1}">1</a>
                </li>
                <li class="page-item" th:classappend="${ordersPage.last} ? 'disabled'">
                    <a class="page-link" th:href="@{/my-orders(page=${ordersPage.number+1}, search=${search}, sort=${param.sort})}">
                        Next
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</main>
<footer>
    <div th:insert="~{footer::footer}"></div>
</footer>
</body>
</html>